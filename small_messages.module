<?php

  /**
   * @file
   * Contains small_messages.module.
   */

  use Drupal\Core\Form\FormStateInterface;
  use Drupal\Core\Routing\RouteMatchInterface;


  /**
   * Implements hook_help().
   */
  function small_messages_help($route_name, RouteMatchInterface $route_match) {
    switch ($route_name) {
      // Main module help for the small_messages module.
      case 'help.page.small_messages':
        $output = '';
        $output .= '<h3>' . t('About') . '</h3>';
        $output .= '<p>' . t('A lightweight message & news system') . '</p>';
        return $output;

      default:
    }
  }


  /**
   * Implements hook_theme().
   */
  function small_messages_theme() {
    return [
      'small_messages' => [
        'render element' => 'children',
      ],
    ];
  }


  /**
   * Implements hook_mail().
   */
  function small_messages_mail($key, &$message, $params) {

    switch ($key) {


      case 'EMAIL_PLAIN':

        $message['from'] = $params['from'];
        $message['subject'] = $params['title'];
        $message['body'][] = $params['message'];
        break;


      case 'EMAIL_SMTP' :

        $message['from'] = $params['from'];
        $message['subject'] = $params['title'];
        $message['headers'] = [
          'MIME-Version' => '1.0',
          'Content-Type' => "multipart/alternative",
          'Content-Transfer-Encoding' => 'quoted-printable',
          'X-Mailer' => 'Drupal',
        ];
        $message['body'][] = "\r\n--\r\n";
        $message['body'][] = 'Content-Type: text/plain; charset=utf-8;';
        $message['body'][] = $params['message'];
        $message['body'][] = "\r\n--\r\n";
        $message['body'][] = "Content-Type: text/html; charset=UTF-8; format=flowed; delsp=yes;";
        $message['body'][] = $params['htmltext'];
        $message['body'][] = "\r\n-- --\r\n";
        break;


      case 'HTML':

        $message['from'] = $params['from'];
        $message['subject'] = $params['title'];
        $message['headers']['Content-Type'] = 'text/html; charset=UTF-8; format=flowed; delsp=yes';
        $message['body'][] = $params['htmltext'];
        break;

    }

  }
  /**
   * Implements hook_form_alter().
   */

  function small_messages_form_alter(&$form, FormStateInterface $form_state, $form_id) {

    // EDIT FORM KONZERT
    if ($form_id == 'node_messages_edit_form' or $form_id == 'node_messages_form') {



    }
  }