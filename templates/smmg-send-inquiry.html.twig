{{ attach_library('small_messages/small_messages.main') }}


    {% set link_messages = path('small_messages.messages') %}
    {% set link_subscribers = path('small_messages.subscribers') %}
    {% set link_send = path('small_messages.subscribers') %}



{% if message.send_date %}
    <div class="smmg-message-status-warning">
        Diese Nachricht wurde am {{ message.send_date }} schon einmal verschickt.
    </div>
{% endif %}


<h2>Nachricht:</h2>
<div class="well">
    <h3>{{ message.title }}</h3>
    <div class="smmg-body">

        {% set body = {
        '#type':   'processed_text',
        '#text':    message.body.value,
        '#format':  message.body.format,
        } %}

        {{ body }}
    </div>
    <div>
        <a type="button" class="btn btn-sm btn-default smmg-body-toggle-trigger">komplette Nachricht anzeigen</a>
    </div>
</div>
<h2>Vorschau:</h2>
<div>
    <a type="button" class="btn btn-sm btn-default smmg-body-htmltext-toggle"> HTML Email</a>
{#
    <a type="button" class="btn btn-sm btn-default smmg-body-plaintext-toggle">Text Email</a>
#}
</div>


<div id="smmg-body-htmltext" style="display: none">
    {{ body }}
</div>

{#
<div id="smmg-body-plaintext" style="display: none">
    {{ body }}
</div>
#}

<h2>{% trans %} Subscribers {% endtrans %}</h2>
<div class="well">

    <div>

        {% for group_tag in subscriber %}

            <div class="btn-tag active smmg-subscriber-group-tag smmg-subscriber-list-trigger"
                 data-subscriber-group-id="{{ group_tag.id }}">
                {{ group_tag.title }} <span class="badge">{{ group_tag.number }}</span></div>

        {% endfor %}


        <div class="btn btn-sm   smmg-subscriber-list-trigger smmg-subscriber-list-description"
             data-subscriber-group-id="0">
            {% trans %} List all Subscribers {% endtrans %}
        </div>

    </div>


    <div class="ajax-container"></div>
    <div class="smmg-subscriber-list">
        {% for group in subscriber %}
            <div class="smmg-subscriber-list-block-{{ group.id }}" style="display:none">
                <h4 class="smmg-subscriber-list-title">{{ group.title }}</h4>
                <ul class="smmg-subscriber-list-column">
                    {% for item in group.list %}

                        <li class="smmg-subscriber-member-{{ item.id }}">
                            <div class="smmg-subscriber-list-edit">

                                {{ item.name }}

                                <span class="smmg-subscriber-list-remove"
                                      data-subscriber-id="{{ item.id }}"
                                      data-subscriber-group-id="{{ group.id }}"
                                      data-toggle="tooltip"
                                      data-delay="1000"
                                      data-placement="right"
                                      title="{% trans %}Remove from subscribers list{% endtrans %} }}">
                                        <i class="fa fa-times-circle" aria-hidden="true"></i>
                                    </span>
                            </div>
                        </li>

                    {% endfor %}

                </ul>
            </div>
        {% endfor %}

        <div class="smmg-subscriber-list-footer">
            <p class="small">
                {% trans %} The message is sent only once to the recipient, even if it appears in several groups.{% endtrans %}
            </p>
        </div>
    </div>
</div>


<div class="smmg-subscriber-foot">
    <button type="button" class="btn btn-default" data-dismiss="modal">{% trans %} Abbrechen {% endtrans %}</button>
    <a href="{{ link_send }}" type="button" class="btn btn-primary">
        <i class="fa fa-paper-plane" aria-hidden="true"></i>
        {% trans %} Nachricht Senden {% endtrans %}
    </a>
</div>